(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}const n=t((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getRandomInteger=function(e,t){return Math.floor(Math.random()*(t-e)+e)}}));function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o=r((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"increase",(function(e){n.balance+=e,n.draw()})),i(this,"draw",(function(){n.$container.innerText="Your Score: ".concat(n.balance)})),this.$container=t,this.balance=0}));function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var u=new WeakMap;const l=s((function e(t){var n,a,r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a=function(){var e,t,n;(e=r,t=u,n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t),function(e,t){return t.get?t.get.call(e):t.value}(e,n)).call(r),r.$container.innerText="Round Time: ".concat(r.time)},(n="draw")in this?Object.defineProperty(this,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):this.draw=a,function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}(this,u,{writable:!0,value:function(){r.timeNow=Date.now();var e=r.timeNow-r.timeStart,t=Math.floor(e/1e3),n=0;t>=60&&(t-=60*(n=Math.floor(t/60))),n=n<10?"0".concat(n):"".concat(n),t=t<10?"0".concat(t):"".concat(t),r.time="".concat(n,":").concat(t)}}),this.$container=t,this.time="00:00",this.timeStart=Date.now(),this.timeNow=this.timeStart,this.draw()}));function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=h((function e(t,a){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"draw",(function(){var e=r.support.getRandomInteger(0,r.splashes.length);r.$container.innerText=r.splashes[e]})),d(this,"end",(function(e){e>=r.winScore?r.$container.innerText="Game Over! You won!":r.$container.innerText="Game Over! You lose!"})),this.$container=t,this.winScore=a,this.support=new n,this.splashes=["Eat all","Big snake","Just out of the oven","We are in the matrix!","Open-world alpha sandbox!","Apples or mice?","Hurry up!","What does this food allow itself?","Beware the tail","Hmmmrmm.","Is it poisonous?","Keep it up!","Ha-ha, nice","Home-made!","Contains simulated food","This splash text is now available","Quite Indie!"],this.draw()}));const w=p;function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function b(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}const v=b((function e(t,n,a){var r,i,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=function(){o.$container.innerHTML="";var e=document.createElement("div");e.classList.add("map"),o.$container.appendChild(e);for(var t=o.height;t>=1;t--)for(var n=1;n<=o.width;n++){var a=document.createElement("div");a.classList.add("cell"),a.setAttribute("x",n),a.setAttribute("y",t),e.appendChild(a)}},(r="draw")in this?Object.defineProperty(this,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):this.draw=i,this.$container=t,this.width=n,this.height=a,this.draw()}));function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){var n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t);return function(e,t){return t.get?t.get.call(e):t.value}(e,n)}var P=new WeakMap,E=new WeakMap;const T=g((function e(t,a){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),x(this,"update",(function(){r.x+=r.dx,r.y+=r.dy,R(r,P).call(r),r.tails.unshift({x:r.x,y:r.y}),r.tails.length>r.maxTails&&r.tails.pop(),r.canRotate=!0})),x(this,"draw",(function(){r.tails.forEach((function(e,t){0===t?document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.add("snakeHead"):document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.add("snakeTail")}))})),k(this,P,{writable:!0,value:function(){r.x>r.map_width?r.x=1:r.x<1&&(r.x=r.map_width),r.y>r.map_height?r.y=1:r.y<1&&(r.y=r.map_height)}}),k(this,E,{writable:!0,value:function(){var e=0,t=0,n=0,a=0;switch(r.support.getRandomInteger(1,5)){case 1:r.dx=0,r.dy=1,r.direction="Up",e=1,t=r.map_width,n=3,a=r.map_height;break;case 2:r.dx=1,r.dy=0,r.direction="Right",e=3,t=r.map_width,n=1,a=r.map_height;break;case 3:r.dx=0,r.dy=-1,r.direction="Down",e=1,t=r.map_width,n=1,a=r.map_height-2;break;default:r.dx=-1,r.dy=0,r.direction="Left",e=1,t=r.map_width-2,n=1,a=r.map_height}r.x=r.support.getRandomInteger(e,t),r.y=r.support.getRandomInteger(n,a),r.tails=[{x:r.x,y:r.y},{x:r.x-r.dx,y:r.y-r.dy},{x:r.x-(r.dx+r.dx),y:r.y-(r.dy+r.dy)}]}}),this.map_width=t,this.map_height=a,this.support=new n,this.x=0,this.y=0,this.dx=0,this.dy=1,this.direction="Up",this.canRotate=!1,this.canGrow=!1,this.isAlive=!0,this.isPaused=!1,this.tails=[],this.maxTails=3,R(this,E).call(this),this.draw()}));function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W(e);if(t){var r=W(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return j(this,n)}}function j(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return I(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function L(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function D(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var C=D((function e(){$(this,e),this.createThing=function(){}})),H=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).createThing=function(){return new B},e}return D(n)}(C),q=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).createThing=function(){return new z},e}return D(n)}(C),G=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).createThing=function(){return new X},e}return D(n)}(C),N=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).createThing=function(){return new J},e}return D(n)}(C),U=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).createThing=function(){return new Q},e}return D(n)}(C),K=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).createThing=function(){return new F},e}return D(n)}(C),Y=D((function e(){var t=this;$(this,e),S(this,"update",(function(){t.rottingStage++})),S(this,"generate",(function(){var e=document.querySelectorAll(".cell"),n=[];e.forEach((function(e){e.classList.contains("snakeTail")||e.classList.contains("snakeHead")||e.classList.contains("thing")||n.push(e)}));var a=t.support.getRandomInteger(1,n.length);t.x=+n[a].getAttribute("x"),t.y=+n[a].getAttribute("y")})),S(this,"draw",(function(){document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.add("thing",t.className)})),this.support=new n,this.x=0,this.y=0,this.rottingStage=0,this.maxRottingStage=0,this.className=""})),B=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),S(I(e=t.call(this)),"update",(function(){})),e.maxRottingStage=0,e.className="border",e.generate(),e.draw(),e}return D(n)}(Y),z=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).maxRottingStage=50,e.className="apple",e.generate(),e.draw(),e}return D(n)}(Y),X=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).maxRottingStage=25,e.className="mouse",e.generate(),e.draw(),e}return D(n)}(Y),J=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).maxRottingStage=25,e.className="holywater",e.generate(),e.draw(),e}return D(n)}(Y),Q=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).maxRottingStage=100,e.className="crap",e.generate(),e.draw(),e}return D(n)}(Y),F=function(e){O(n,e);var t=M(n);function n(){var e;return $(this,n),(e=t.call(this)).maxRottingStage=100,e.className="bomb",e.generate(),e.draw(),e}return D(n)}(Y);function V(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Z(e,t,n){return t&&V(e.prototype,t),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ee(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function te(e,t){var n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t);return function(e,t){return t.get?t.get.call(e):t.value}(e,n)}var ne=new WeakMap,ae=new WeakMap,re=new WeakMap,ie=new WeakMap,oe=new WeakMap,ce=new WeakMap,se=new WeakMap,ue=new WeakMap,le=new WeakMap,fe=new WeakMap,he=new WeakMap;new(Z((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ee(this,ne,{writable:!0,value:function(){t.map=new v(t.$MAP_WRAPPER,t.MAP_WIDTH,t.MAP_HEIGHT),t.score=new o(t.$SCORE_WRAPPER),t.timer=new l(t.$TIMER_WRAPPER),t.dialog=new w(t.$DIALOG_WRAPPER,t.WIN_SCORE),t.snake=new T(t.MAP_WIDTH,t.MAP_HEIGHT),t.factories=[new H,new q,new G,new N,new U,new K],t.things=[],t.borders=[];for(var e=0;e<5;e++)t.borders.push(t.factories[0].createThing());for(var n=0;n<2;n++)t.things.push(t.factories[1].createThing());t.interval=setInterval(te(t,ae),t.SPEED_RATE)}}),ee(this,ae,{writable:!0,value:function(){te(t,re).call(t),te(t,ie).call(t),te(t,oe).call(t)}}),ee(this,re,{writable:!0,value:function(){t.snake.update(),t.things.forEach((function(e){e.update()}))}}),ee(this,ie,{writable:!0,value:function(){t.map.draw(),t.score.draw(),t.timer.draw(),t.snake.draw(),t.things.forEach((function(e){e.draw()})),t.borders.forEach((function(e){e.draw()}))}}),ee(this,oe,{writable:!0,value:function(){if(t.score.balance>=3?t.snake.canGrow=!0:t.snake.canGrow=!1,t.things.forEach((function(e,n){e.rottingStage>e.maxRottingStage&&t.things.splice(n,1),t.snake.x===e.x&&t.snake.y===e.y&&(document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("apple")&&(t.snake.canGrow&&t.snake.maxTails++,t.score.increase(1),t.map.draw(),t.snake.draw(),t.borders.forEach((function(e){e.draw()})),t.things.splice(n,1)),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("mouse")&&(t.snake.canGrow&&t.snake.maxTails++,t.score.increase(5),t.map.draw(),t.snake.draw(),t.borders.forEach((function(e){e.draw()})),t.things.splice(n,1)),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("holywater")&&(t.snake.maxTails>=5&&(t.snake.maxTails-=2,t.snake.tails.pop(),t.snake.tails.pop()),t.map.draw(),t.snake.draw(),t.borders.forEach((function(e){e.draw()})),t.things.splice(n,1)),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("crap")&&(t.snake.maxTails>=5&&(t.snake.maxTails-=2,t.snake.tails.pop(),t.snake.tails.pop()),t.score.increase(-10),t.map.draw(),t.snake.draw(),t.borders.forEach((function(e){e.draw()})),t.score.balance<0&&(t.snake.isAlive=!1,t.dialog.end(t.score.balance),clearInterval(t.interval))),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("bomb")&&(t.snake.isAlive=!1,t.dialog.end(t.score.balance),clearInterval(t.interval)))})),t.things.length<2){var e=t.support.getRandomInteger(1,100),n=0;e<=80?n=1:e>80&&e<=85?n=2:e>85&&e<=90?n=3:e>90&&e<=95?n=4:e>95&&(n=5),t.things.push(t.factories[n].createThing()),t.things.forEach((function(e){e.draw()}))}(document.querySelector(".snakeHead").classList.contains("snakeTail")||document.querySelector(".snakeHead").classList.contains("border")||t.score.balance>=t.WIN_SCORE)&&(t.snake.isAlive=!1,t.dialog.end(t.score.balance),clearInterval(t.interval))}}),ee(this,ce,{writable:!0,value:function(){window.addEventListener("keydown",(function(e){!0===t.snake.canRotate&&("ArrowLeft"!==e.code&&"KeyA"!==e.code||"Right"===t.snake.direction?"ArrowUp"!==e.code&&"KeyW"!==e.code||"Down"===t.snake.direction?"ArrowRight"!==e.code&&"KeyD"!==e.code||"Left"===t.snake.direction?"ArrowDown"!==e.code&&"KeyS"!==e.code||"Up"===t.snake.direction||(t.snake.dx=0,t.snake.dy=-1,t.snake.direction="Down",t.snake.canRotate=!1):(t.snake.dx=1,t.snake.dy=0,t.snake.direction="Right",t.snake.canRotate=!1):(t.snake.dx=0,t.snake.dy=1,t.snake.direction="Up",t.snake.canRotate=!1):(t.snake.dx=-1,t.snake.dy=0,t.snake.direction="Left",t.snake.canRotate=!1)),"KeyR"===e.code&&(clearInterval(t.interval),te(t,ne).call(t)),!0===t.snake.isAlive&&"KeyP"===e.code&&(!0===t.snake.isPaused?(t.interval=setInterval(te(t,ae),t.SPEED_RATE),t.snake.isPaused=!1):(clearInterval(t.interval),t.snake.isPaused=!0))}))}}),ee(this,se,{writable:!0,value:function(){var e=0;"getGamepads"in window.navigator&&window.addEventListener("gamepadconnected",(function(){setInterval((function(){e+=10;var n,a=navigator.getGamepads(),r=!1;a[0].buttons.forEach((function(e,t){1===e.value&&(n=t,r=!0)})),r&&function(n){!0===t.snake.canRotate&&(12===n&&"Down"!==t.snake.direction?(t.snake.dx=0,t.snake.dy=1,t.snake.direction="Up",t.snake.canRotate=!1):13===n&&"Up"!==t.snake.direction?(t.snake.dx=0,t.snake.dy=-1,t.snake.direction="Down",t.snake.canRotate=!1):14===n&&"Right"!==t.snake.direction?(t.snake.dx=-1,t.snake.dy=0,t.snake.direction="Left",t.snake.canRotate=!1):15===n&&"Left"!==t.snake.direction&&(t.snake.dx=1,t.snake.dy=0,t.snake.direction="Right",t.snake.canRotate=!1)),e>=500&&(!0===t.snake.isAlive&&2===n&&(!0===t.snake.isPaused?(t.interval=setInterval(te(t,ae),t.SPEED_RATE),t.snake.isPaused=!1,e=0):(clearInterval(t.interval),t.snake.isPaused=!0,e=0)),3===n&&(clearInterval(t.interval),te(t,ne).call(t),e=0))}(n)}),10)}))}}),ee(this,ue,{writable:!0,value:function(){var e=0,n=0,a=0,r=0;t.$MAP_WRAPPER.addEventListener("touchstart",(function(t){e=t.touches[0].pageX,n=t.touches[0].pageY})),t.$MAP_WRAPPER.addEventListener("touchend",(function(i){a=i.changedTouches[0].pageX,r=i.changedTouches[0].pageY;var o=a-e,c=r-n,s=Math.abs(o)>Math.abs(c),u=Math.abs(c)>Math.abs(o);!0===t.snake.canRotate&&(o>0&&s&&"Left"!==t.snake.direction?(t.snake.dx=1,t.snake.dy=0,t.snake.direction="Right",t.snake.canRotate=!1):o<0&&s&&"Right"!==t.snake.direction?(t.snake.dx=-1,t.snake.dy=0,t.snake.direction="Left",t.snake.canRotate=!1):c>0&&u&&"Up"!==t.snake.direction?(t.snake.dx=0,t.snake.dy=-1,t.snake.direction="Down",t.snake.canRotate=!1):c<0&&u&&"Down"!==t.snake.direction&&(t.snake.dx=0,t.snake.dy=1,t.snake.direction="Up",t.snake.canRotate=!1))}))}}),ee(this,le,{writable:!0,value:function(){t.MAP_WIDTH=15,t.MAP_HEIGHT=15,t.WIN_SCORE=100,t.SPEED_RATE=200}}),ee(this,fe,{writable:!0,value:function(){t.$MAP_WRAPPER=document.querySelector(".snake-game__map-wrapper"),t.$SCORE_WRAPPER=document.querySelector(".snake-game__score"),t.$TIMER_WRAPPER=document.querySelector(".snake-game__timer"),t.$DIALOG_WRAPPER=document.querySelector(".snake-game__dialog")}}),ee(this,he,{writable:!0,value:function(){te(t,ce).call(t),te(t,se).call(t),te(t,ue).call(t)}}),te(this,le).call(this),te(this,fe).call(this),te(this,he).call(this),this.support=new n,te(this,ne).call(this)})))})();