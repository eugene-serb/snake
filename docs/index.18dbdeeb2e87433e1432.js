(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,o=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===t(o)?o:String(o)),i)}var o}const n=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$container=e,this.width=n,this.height=r,this.draw()}var n,r;return n=t,(r=[{key:"draw",value:function(){this.$container.innerHTML="";var t=document.createElement("div");t.classList.add("map"),this.$container.appendChild(t);for(var e=this.height;e>=1;e--)for(var n=1;n<=this.width;n++){var r=document.createElement("div");r.classList.add("cell"),r.setAttribute("x",n),r.setAttribute("y",e),t.appendChild(r)}}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function r(t,e){var n=t&&"number"==typeof t?t:0,r=e&&"number"==typeof e?e:0;return Math.floor(Math.random()*(r-n)+n)}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===i(o)?o:String(o)),r)}var o}function a(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function s(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var c=new WeakSet,u=new WeakSet;function l(){this.x>this.map_width?this.x=1:this.x<1&&(this.x=this.map_width),this.y>this.map_height?this.y=1:this.y<1&&(this.y=this.map_height)}function f(){var t=0,e=0,n=0,i=0;switch(r(1,5)){case 1:this.dx=0,this.dy=1,this.direction="Up",t=1,e=this.map_width,n=3,i=this.map_height;break;case 2:this.dx=1,this.dy=0,this.direction="Right",t=3,e=this.map_width,n=1,i=this.map_height;break;case 3:this.dx=0,this.dy=-1,this.direction="Down",t=1,e=this.map_width,n=1,i=this.map_height-2;break;default:this.dx=-1,this.dy=0,this.direction="Left",t=1,e=this.map_width-2,n=1,i=this.map_height}this.x=r(t,e),this.y=r(n,i),this.tails=[{x:this.x,y:this.y},{x:this.x-this.dx,y:this.y-this.dy},{x:this.x-(this.dx+this.dx),y:this.y-(this.dy+this.dy)}]}const h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,u),a(this,c),this.map_width=e,this.map_height=n,this.x=0,this.y=0,this.dx=0,this.dy=1,this.direction="Up",this.canRotate=!1,this.canGrow=!1,this.isAlive=!0,this.isPaused=!1,this.tails=[],this.maxTails=3,s(this,u,f).call(this),this.draw()}var e,n;return e=t,(n=[{key:"update",value:function(){this.x+=this.dx,this.y+=this.dy,s(this,c,l).call(this),this.tails.unshift({x:this.x,y:this.y}),this.tails.length>this.maxTails&&this.tails.pop(),this.canRotate=!0}},{key:"draw",value:function(){this.tails.forEach((function(t,e){0===e?document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.add("snakeHead"):document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.add("snakeTail")}))}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===y(i)?i:String(i)),r)}var i}var v=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$container=e,this.winScore=n,this.splashes=["Eat all","Big snake","Just out of the oven","We are in the matrix!","Open-world alpha sandbox!","Apples or mice?","Hurry up!","What does this food allow itself?","Beware the tail","Hmmmrmm.","Is it poisonous?","Keep it up!","Ha-ha, nice","Home-made!","Contains simulated food","This splash text is now available","Quite Indie!"],this.draw()}var e,n;return e=t,n=[{key:"draw",value:function(){var t=r(0,this.splashes.length);this.$container.innerText=this.splashes[t]}},{key:"end",value:function(t){t>=this.winScore?this.$container.innerText="Game Over! You won!":this.$container.innerText="Game Over! You lose!"}}],n&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();const m=v;function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===d(i)?i:String(i)),r)}var i}function w(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function g(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var S=new WeakSet,k=new WeakSet;function _(){this._timeStart=Date.now(),this._timeNow=this._timeStart,this._value="00:00"}function T(){this._timeNow=Date.now();var t=this._timeNow-this._timeStart,e=Math.floor(t/1e3),n=0;e>=60&&(e-=60*(n=Math.floor(e/60))),n=n<10?"0".concat(n):"".concat(n),e=e<10?"0".concat(e):"".concat(e),this._value="".concat(n,":").concat(e)}const x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),w(this,k),w(this,S),g(this,S,_).call(this)}var e,n;return e=t,(n=[{key:"value",get:function(){return g(this,k,T).call(this),this._value}},{key:"reset",value:function(){g(this,S,_).call(this)}}])&&b(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==E(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===E(i)?i:String(i)),r)}var i}const R=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e&&"number"==typeof e?e:0}var e,n;return e=t,(n=[{key:"value",get:function(){return this._value},set:function(t){t&&"number"==typeof t&&(this._value=t)}},{key:"increase",value:function(t){this._value+=t&&"number"==typeof t?t:1}},{key:"decrease",value:function(t){this._value-=t&&"number"==typeof t?t:1}},{key:"reset",value:function(){this._value=0}}])&&P(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==j(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===j(i)?i:String(i)),r)}var i}function A(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function C(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var I=new WeakSet,W=new WeakSet,L=new WeakSet,G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,L),A(this,W),A(this,I),this._key=e,this._value=[],C(this,L,D).call(this)}var e,n;return e=t,n=[{key:"value",get:function(){return C(this,L,D).call(this),this._value}},{key:"add",value:function(t,e){if(t&&"number"==typeof t&&e&&"string"==typeof e){var n={date:Date.now(),score:t,time:e};this._value.push(n),C(this,I,N).call(this),C(this,W,M).call(this)}}},{key:"clean",value:function(){this._value=[],C(this,W,M).call(this)}}],n&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function N(){this._value.sort((function(t,e){return t.score<e.score?1:t.score>e.score?-1:void 0}))}function M(){localStorage.setItem(this._key,JSON.stringify(this._value))}function D(){localStorage[this._key]?this._value=JSON.parse(localStorage[this._key]):this._value=[],C(this,I,N).call(this)}const $=G;function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==H(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===H(i)?i:String(i)),r)}var i}function U(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var K=new WeakSet;function z(){this.interval=null,this.isGameOver=!1,this.isPaused=!1,this.canMove=!0}const Y=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,n=K),n.add(e),U(this,K,z).call(this)}var e,n;return e=t,(n=[{key:"start",value:function(){this.isGameOver&&this.clear(),this.isPaused=!1,this.canMove=!0}},{key:"stop",value:function(){this.isPaused=!0,this.canMove=!1,clearTimeout(this.interval)}},{key:"setGameOver",value:function(){this.isGameOver=!0,this.stop()}},{key:"clear",value:function(){this.stop(),U(this,K,z).call(this)}}])&&q(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==B(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===B(i)?i:String(i)),r)}var i}function X(t,e,n){return e&&J(t.prototype,e),n&&J(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Q=new WeakSet;function F(){var t=this;window.addEventListener("keydown",(function(e){t._context.isGameOver||("ArrowLeft"===e.code||"KeyA"===e.code?t._context.moveToLeft():"ArrowUp"===e.code||"KeyW"===e.code?t._context.moveToUp():"ArrowRight"===e.code||"KeyD"===e.code?t._context.moveToRight():"ArrowDown"!==e.code&&"KeyS"!==e.code||t._context.moveToDown()),"KeyR"===e.code&&(t._context.clear(),t._context.start()),"KeyP"===e.code&&(t._context.isGameOver||(t._context.isPaused?t._context.start():t._context.stop()))}))}const V=X((function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,r=Q),r.add(n),this._context=e,function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,Q,F).call(this)}));function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Z(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Z(i)?i:String(i)),r)}var i}function nt(t,e,n){return e&&et(t.prototype,e),n&&et(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rt(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function it(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ot=new WeakSet,at=new WeakSet,st=new WeakSet,ct=new WeakSet;function ut(){it(this,ct,ht).call(this)&&(this.LISTENER_INTERRUPT=10,this.KEYPRESS_INTERRUPT=500,this._gamepadInterval=null,this._keypressCooldown=0,it(this,at,lt).call(this))}function lt(){var t=this;window.addEventListener("gamepadconnected",(function(){t._gamepadInterval=setInterval((function(){t._keypressCooldown+=t.LISTENER_INTERRUPT;var e,n,r=(e=navigator.getGamepads(),n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,n)||function(t,e){if(t){if("string"==typeof t)return tt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],i=!1,o=null;r.buttons.forEach((function(t,e){1===t.value&&(o=e,i=!0)})),i&&it(t,st,ft).call(t,o)}),t.LISTENER_INTERRUPT)}))}function ft(t){12===t&&(this._context.moveToUp(),this._keypressCooldown=0),13===t&&(this._context.moveToDown(),this._keypressCooldown=0),14===t&&(this._context.moveToLeft(),this._keypressCooldown=0),15===t&&(this._context.moveToRight(),this._keypressCooldown=0),this._keypressCooldown>=this.KEYPRESS_INTERRUPT&&(8===t&&(this._context.isPaused?(this._context.start(),this._keypressCooldown=0):(this._context.stop(),this._keypressCooldown=0)),9===t&&(this._context.clear(),this._context.start(),this._keypressCooldown=0))}function ht(){return"getGamepads"in window.navigator}const yt=nt((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),rt(this,ct),rt(this,st),rt(this,at),rt(this,ot),this._context=e,it(this,ot,ut).call(this)}));function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==pt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===pt(i)?i:String(i)),r)}var i}function mt(t,e,n){return e&&vt(t.prototype,e),n&&vt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var dt=new WeakSet;function bt(){var t=this,e=0,n=0;this._container.addEventListener("touchstart",(function(t){e=t.touches[0].pageX,n=t.touches[0].pageY})),this._container.addEventListener("touchend",(function(r){var i=r.changedTouches[0].pageX,o=r.changedTouches[0].pageY,a=i-e,s=o-n,c=Math.abs(a)>Math.abs(s),u=Math.abs(s)>Math.abs(a);a>0&&c?t._context.moveToRight():a<0&&c?t._context.moveToLeft():s>0&&u?t._context.moveToDown():s<0&&u&&t._context.moveToUp()}))}const wt=mt((function t(e,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(r=this,i=dt),i.add(r),this._context=e,this._container=n,function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,dt,bt).call(this)}));function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function St(t,e,n){return(e=jt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}function _t(t,e){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_t(t,e)}function Tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Et(t);if(e){var i=Et(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xt(t)}(this,n)}}function xt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jt(r.key),r)}}function Rt(t,e,n){return e&&Pt(t.prototype,e),n&&Pt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jt(t){var e=function(t,e){if("object"!==gt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===gt(e)?e:String(e)}function Ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var At=Rt((function t(){Ot(this,t),this.createThing=function(){}})),Ct=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).createThing=function(){return new Dt},t}return Rt(n)}(At),It=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).createThing=function(){return new $t},t}return Rt(n)}(At),Wt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).createThing=function(){return new Ht},t}return Rt(n)}(At),Lt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).createThing=function(){return new qt},t}return Rt(n)}(At),Gt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).createThing=function(){return new Ut},t}return Rt(n)}(At),Nt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).createThing=function(){return new Kt},t}return Rt(n)}(At),Mt=Rt((function t(){var e=this;Ot(this,t),St(this,"update",(function(){e.rottingStage++})),St(this,"generate",(function(){var t=document.querySelectorAll(".cell"),n=[];t.forEach((function(t){t.classList.contains("snakeTail")||t.classList.contains("snakeHead")||t.classList.contains("thing")||n.push(t)}));var i=r(1,n.length);e.x=+n[i].getAttribute("x"),e.y=+n[i].getAttribute("y")})),St(this,"draw",(function(){document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.add("thing",e.className)})),this.x=0,this.y=0,this.rottingStage=0,this.maxRottingStage=0,this.className=""})),Dt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),St(xt(t=e.call(this)),"update",(function(){})),t.maxRottingStage=0,t.className="border",t.generate(),t.draw(),t}return Rt(n)}(Mt),$t=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).maxRottingStage=50,t.className="apple",t.generate(),t.draw(),t}return Rt(n)}(Mt),Ht=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).maxRottingStage=25,t.className="mouse",t.generate(),t.draw(),t}return Rt(n)}(Mt),qt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).maxRottingStage=25,t.className="holywater",t.generate(),t.draw(),t}return Rt(n)}(Mt),Ut=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).maxRottingStage=100,t.className="crap",t.generate(),t.draw(),t}return Rt(n)}(Mt),Kt=function(t){kt(n,t);var e=Tt(n);function n(){var t;return Ot(this,n),(t=e.call(this)).maxRottingStage=100,t.className="bomb",t.generate(),t.draw(),t}return Rt(n)}(Mt);function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==zt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===zt(i)?i:String(i)),r)}var i}function Bt(){return Bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Bt.apply(this,arguments)}function Jt(t,e){return Jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Jt(t,e)}function Xt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}function Ft(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Vt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Zt=new WeakSet,te=new WeakSet,ee=new WeakSet,ne=new WeakSet,re=new WeakSet,ie=new WeakSet,oe=new WeakSet,ae=new WeakSet,se=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jt(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qt(r);if(i){var n=Qt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xt(t)}(this,t)});function a(t){var e,n,r,i,s,c,u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Ft(Xt(u=o.call(this)),ae),Ft(Xt(u),oe),Ft(Xt(u),ie),Ft(Xt(u),re),Ft(Xt(u),ne),Ft(Xt(u),ee),Ft(Xt(u),te),Ft(Xt(u),Zt),u._params=t,u.SPEED_RATE=null!==(e=u._params)&&void 0!==e&&e.speedRate&&"number"==typeof(null===(n=u._params)||void 0===n?void 0:n.speedRate)?null===(r=u._params)||void 0===r?void 0:r.speedRate:250,u.KEY_RATING=null!==(i=u._params)&&void 0!==i&&i.keyRating&&"string"==typeof(null===(s=u._params)||void 0===s?void 0:s.keyRating)?null===(c=u._params)||void 0===c?void 0:c.keyRating:"es:snake",Vt(Xt(u),oe,pe).call(Xt(u)),Vt(Xt(u),ie,ye).call(Xt(u)),Vt(Xt(u),ae,ve).call(Xt(u)),Vt(Xt(u),Zt,ce).call(Xt(u)),u}return e=a,n=[{key:"moveToLeft",value:function(){!0===this.snake.canRotate&&"Right"!==this.snake.direction&&(this.snake.dx=-1,this.snake.dy=0,this.snake.direction="Left",this.snake.canRotate=!1)}},{key:"moveToUp",value:function(){!0===this.snake.canRotate&&"Down"!==this.snake.direction&&(this.snake.dx=0,this.snake.dy=1,this.snake.direction="Up",this.snake.canRotate=!1)}},{key:"moveToRight",value:function(){!0===this.snake.canRotate&&"Left"!==this.snake.direction&&(this.snake.dx=1,this.snake.dy=0,this.snake.direction="Right",this.snake.canRotate=!1)}},{key:"moveToDown",value:function(){!0===this.snake.canRotate&&"Up"!==this.snake.direction&&(this.snake.dx=0,this.snake.dy=-1,this.snake.direction="Down",this.snake.canRotate=!1)}},{key:"start",value:function(){Bt(Qt(a.prototype),"start",this).call(this),this.interval=setInterval(Vt(this,te,ue).bind(this),this.SPEED_RATE)}},{key:"setGameOver",value:function(){Bt(Qt(a.prototype),"setGameOver",this).call(this);var t=this.score.value,e=this.timer.value;this.rating.add(t,e),this.drawRating()}},{key:"clear",value:function(){Bt(Qt(a.prototype),"clear",this).call(this),Vt(this,Zt,ce).call(this)}},{key:"drawRating",value:function(){this.$RATING.innerHTML="";for(var t=this.rating.value,e=0;e<t.length&&e<10;e++){var n=document.createElement("tr"),r=document.createElement("td"),i=document.createElement("td"),o=document.createElement("td"),a=document.createElement("td"),s=new Date(t[e].date);r.innerText=e+1,i.innerText=t[e].score,o.innerText=t[e].time,a.innerText=s.toLocaleDateString(),n.append(r,i,o,a),this.$RATING.appendChild(n)}}}],n&&Yt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Y);function ce(){this.rating=new $(this.KEY_RATING),this.drawRating(),this.drawer=new n(this.$MAP_WRAPPER,this.MAP_WIDTH,this.MAP_HEIGHT),this.dialog=new m(this.$DIALOG_WRAPPER,this.WIN_SCORE),this.snake=new h(this.MAP_WIDTH,this.MAP_HEIGHT),this.timer=new x,this.score=new R,this.factories=[new Ct,new It,new Wt,new Lt,new Gt,new Nt],this.things=[],this.borders=[];for(var t=0;t<5;t++)this.borders.push(this.factories[0].createThing());for(var e=0;e<2;e++)this.things.push(this.factories[1].createThing())}function ue(){Vt(this,ee,le).call(this),Vt(this,ne,fe).call(this),Vt(this,re,he).call(this)}function le(){this.snake.update(),this.things.forEach((function(t){t.update()}))}function fe(){this.drawer.draw(),this.snake.draw(),this.things.forEach((function(t){t.draw()})),this.borders.forEach((function(t){t.draw()})),this.$TIMER.innerText="Time: ".concat(this.timer.value),this.$SCORE.innerText="Score: ".concat(this.score.value)}function he(){var t=this;if(this.score.value>=3?this.snake.canGrow=!0:this.snake.canGrow=!1,this.things.forEach((function(e,n){e.rottingStage>e.maxRottingStage&&t.things.splice(n,1),t.snake.x===e.x&&t.snake.y===e.y&&(document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("apple")&&(t.snake.canGrow&&t.snake.maxTails++,t.score.increase(1),t.drawer.draw(),t.snake.draw(),t.borders.forEach((function(t){t.draw()})),t.things.splice(n,1)),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("mouse")&&(t.snake.canGrow&&t.snake.maxTails++,t.score.increase(5),t.drawer.draw(),t.snake.draw(),t.borders.forEach((function(t){t.draw()})),t.things.splice(n,1)),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("holywater")&&(t.snake.maxTails>=5&&(t.snake.maxTails-=2,t.snake.tails.pop(),t.snake.tails.pop()),t.drawer.draw(),t.snake.draw(),t.borders.forEach((function(t){t.draw()})),t.things.splice(n,1)),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("crap")&&(t.snake.maxTails>=5&&(t.snake.maxTails-=2,t.snake.tails.pop(),t.snake.tails.pop()),t.score.decrease(10),t.drawer.draw(),t.snake.draw(),t.borders.forEach((function(t){t.draw()})),t.score.value<0&&(t.snake.isAlive=!1,t.dialog.end(t.score.value),t.setGameOver())),document.querySelector('[x = "'.concat(e.x,'"][y = "').concat(e.y,'"]')).classList.contains("bomb")&&(t.snake.isAlive=!1,t.dialog.end(t.score.value),t.setGameOver()))})),this.things.length<2){var e=r(1,100),n=0;e<=80?n=1:e>80&&e<=85?n=2:e>85&&e<=90?n=3:e>90&&e<=95?n=4:e>95&&(n=5),this.things.push(this.factories[n].createThing()),this.things.forEach((function(t){t.draw()}))}(document.querySelector(".snakeHead").classList.contains("snakeTail")||document.querySelector(".snakeHead").classList.contains("border")||this.score.value>=this.WIN_SCORE)&&(this.snake.isAlive=!1,this.dialog.end(this.score.value),this.setGameOver())}function ye(){this.MAP_WIDTH=15,this.MAP_HEIGHT=15,this.WIN_SCORE=100}function pe(){this.$MAP_WRAPPER=document.querySelector("#map"),this.$DIALOG_WRAPPER=document.querySelector("#dialog"),this.$TIMER=document.querySelector("#timer"),this.$SCORE=document.querySelector("#score"),this.$RATING=document.querySelector("#rating")}function ve(){this._keyboard=new V(this),this._gamepads=new yt(this),this._touchscreen=new wt(this,this.$MAP_WRAPPER)}new se({speedRate:200,keyRating:"es:snake"}).start()})();