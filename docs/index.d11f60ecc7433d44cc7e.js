(()=>{"use strict";function t(t,e){var n=t&&"number"==typeof t?t:0,r=e&&"number"==typeof e?e:0;return Math.floor(Math.random()*(r-n)+n)}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var a=r((function e(n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"draw",(function(){var e=t(0,i.splashes.length);i.$container.innerText=i.splashes[e]})),o(this,"end",(function(t){t>=i.winScore?i.$container.innerText="Game Over! You won!":i.$container.innerText="Game Over! You lose!"})),this.$container=n,this.winScore=r,this.splashes=["Eat all","Big snake","Just out of the oven","We are in the matrix!","Open-world alpha sandbox!","Apples or mice?","Hurry up!","What does this food allow itself?","Beware the tail","Hmmmrmm.","Is it poisonous?","Keep it up!","Ha-ha, nice","Home-made!","Contains simulated food","This splash text is now available","Quite Indie!"],this.draw()}));const c=a;function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===s(e)?e:String(e)}const h=l((function t(e,n,r){var o,i,a,c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=function(){c.$container.innerHTML="";var t=document.createElement("div");t.classList.add("map"),c.$container.appendChild(t);for(var e=c.height;e>=1;e--)for(var n=1;n<=c.width;n++){var r=document.createElement("div");r.classList.add("cell"),r.setAttribute("x",n),r.setAttribute("y",e),t.appendChild(r)}},(i=f(i="draw"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,this.$container=e,this.width=n,this.height=r,this.draw()}));function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,b(r.key),r)}}function d(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function v(t,e,n){return(e=b(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b(t){var e=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===y(e)?e:String(e)}function w(t,e){var n=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e);return function(t,e){return e.get?e.get.call(t):e.value}(t,n)}var g=new WeakMap,S=new WeakMap;const k=d((function e(n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,"update",(function(){o.x+=o.dx,o.y+=o.dy,w(o,g).call(o),o.tails.unshift({x:o.x,y:o.y}),o.tails.length>o.maxTails&&o.tails.pop(),o.canRotate=!0})),v(this,"draw",(function(){o.tails.forEach((function(t,e){0===e?document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.add("snakeHead"):document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.add("snakeTail")}))})),m(this,g,{writable:!0,value:function(){o.x>o.map_width?o.x=1:o.x<1&&(o.x=o.map_width),o.y>o.map_height?o.y=1:o.y<1&&(o.y=o.map_height)}}),m(this,S,{writable:!0,value:function(){var e=0,n=0,r=0,i=0;switch(t(1,5)){case 1:o.dx=0,o.dy=1,o.direction="Up",e=1,n=o.map_width,r=3,i=o.map_height;break;case 2:o.dx=1,o.dy=0,o.direction="Right",e=3,n=o.map_width,r=1,i=o.map_height;break;case 3:o.dx=0,o.dy=-1,o.direction="Down",e=1,n=o.map_width,r=1,i=o.map_height-2;break;default:o.dx=-1,o.dy=0,o.direction="Left",e=1,n=o.map_width-2,r=1,i=o.map_height}o.x=t(e,n),o.y=t(r,i),o.tails=[{x:o.x,y:o.y},{x:o.x-o.dx,y:o.y-o.dy},{x:o.x-(o.dx+o.dx),y:o.y-(o.dy+o.dy)}]}}),this.map_width=n,this.map_height=r,this.x=0,this.y=0,this.dx=0,this.dy=1,this.direction="Up",this.canRotate=!1,this.canGrow=!1,this.isAlive=!0,this.isPaused=!1,this.tails=[],this.maxTails=3,w(this,S).call(this),this.draw()}));function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function x(t,e,n){return(e=L(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j(t);if(e){var o=j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R(this,n)}}function R(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function C(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function L(t){var e=function(t,e){if("object"!==_(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===_(e)?e:String(e)}function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var I=C((function t(){W(this,t),this.createThing=function(){}})),M=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).createThing=function(){return new q},t}return C(n)}(I),G=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).createThing=function(){return new K},t}return C(n)}(I),D=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).createThing=function(){return new z},t}return C(n)}(I),N=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).createThing=function(){return new B},t}return C(n)}(I),H=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).createThing=function(){return new Y},t}return C(n)}(I),$=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).createThing=function(){return new X},t}return C(n)}(I),U=C((function e(){var n=this;W(this,e),x(this,"update",(function(){n.rottingStage++})),x(this,"generate",(function(){var e=document.querySelectorAll(".cell"),r=[];e.forEach((function(t){t.classList.contains("snakeTail")||t.classList.contains("snakeHead")||t.classList.contains("thing")||r.push(t)}));var o=t(1,r.length);n.x=+r[o].getAttribute("x"),n.y=+r[o].getAttribute("y")})),x(this,"draw",(function(){document.querySelector('[x = "'.concat(n.x,'"][y = "').concat(n.y,'"]')).classList.add("thing",n.className)})),this.x=0,this.y=0,this.rottingStage=0,this.maxRottingStage=0,this.className=""})),q=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),x(O(t=e.call(this)),"update",(function(){})),t.maxRottingStage=0,t.className="border",t.generate(),t.draw(),t}return C(n)}(U),K=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).maxRottingStage=50,t.className="apple",t.generate(),t.draw(),t}return C(n)}(U),z=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).maxRottingStage=25,t.className="mouse",t.generate(),t.draw(),t}return C(n)}(U),B=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).maxRottingStage=25,t.className="holywater",t.generate(),t.draw(),t}return C(n)}(U),Y=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).maxRottingStage=100,t.className="crap",t.generate(),t.draw(),t}return C(n)}(U),X=function(t){T(n,t);var e=E(n);function n(){var t;return W(this,n),(t=e.call(this)).maxRottingStage=100,t.className="bomb",t.generate(),t.draw(),t}return C(n)}(U);function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==J(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===J(o)?o:String(o)),r)}var o}function F(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function V(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Z=new WeakSet,tt=new WeakSet;function et(){this._timeStart=Date.now(),this._timeNow=this._timeStart,this._value="00:00"}function nt(){this._timeNow=Date.now();var t=this._timeNow-this._timeStart,e=Math.floor(t/1e3),n=0;e>=60&&(e-=60*(n=Math.floor(e/60))),n=n<10?"0".concat(n):"".concat(n),e=e<10?"0".concat(e):"".concat(e),this._value="".concat(n,":").concat(e)}const rt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),F(this,tt),F(this,Z),V(this,Z,et).call(this)}var e,n;return e=t,(n=[{key:"value",get:function(){return V(this,tt,nt).call(this),this._value}},{key:"reset",value:function(){V(this,Z,et).call(this)}}])&&Q(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ot(o)?o:String(o)),r)}var o}const at=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e&&"number"==typeof e?e:0}var e,n;return e=t,(n=[{key:"value",get:function(){return this._value},set:function(t){t&&"number"==typeof t&&(this._value=t)}},{key:"increase",value:function(t){this._value+=t&&"number"==typeof t?t:1}},{key:"decrease",value:function(t){this._value-=t&&"number"==typeof t?t:1}},{key:"reset",value:function(){this._value=0}}])&&it(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ct(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ct(o)?o:String(o)),r)}var o}function ut(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var lt=new WeakSet;function ft(){this.interval=null,this.isGameOver=!1,this.isPaused=!1,this.canMove=!0}const ht=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,n=lt),n.add(e),ut(this,lt,ft).call(this)}var e,n;return e=t,(n=[{key:"start",value:function(){this.isGameOver&&this.clear(),this.isPaused=!1,this.canMove=!0}},{key:"stop",value:function(){this.isPaused=!0,this.canMove=!1,clearTimeout(this.interval)}},{key:"setGameOver",value:function(){this.isGameOver=!0,this.stop()}},{key:"clear",value:function(){this.stop(),ut(this,lt,ft).call(this)}}])&&st(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==yt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===yt(o)?o:String(o)),r)}var o}function dt(t,e,n){return e&&pt(t.prototype,e),n&&pt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var mt=new WeakSet;function vt(){var t=this;window.addEventListener("keydown",(function(e){t._context.isGameOver||("ArrowLeft"===e.code||"KeyA"===e.code?t._context.moveToLeft():"ArrowUp"===e.code||"KeyW"===e.code?t._context.moveToUp():"ArrowRight"===e.code||"KeyD"===e.code?t._context.moveToRight():"ArrowDown"!==e.code&&"KeyS"!==e.code||t._context.moveToDown()),"KeyR"===e.code&&(t._context.clear(),t._context.start()),"KeyP"===e.code&&(t._context.isGameOver||(t._context.isPaused?t._context.start():t._context.stop()))}))}const bt=dt((function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,r=mt),r.add(n),this._context=e,function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,mt,vt).call(this)}));function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==wt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===wt(o)?o:String(o)),r)}var o}function kt(t,e,n){return e&&St(t.prototype,e),n&&St(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _t(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function xt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Tt=new WeakSet,Pt=new WeakSet,Et=new WeakSet,Rt=new WeakSet;function Ot(){xt(this,Rt,Ct).call(this)&&(this.LISTENER_INTERRUPT=10,this.KEYPRESS_INTERRUPT=500,this._gamepadInterval=null,this._keypressCooldown=0,xt(this,Pt,jt).call(this))}function jt(){var t=this;window.addEventListener("gamepadconnected",(function(){t._gamepadInterval=setInterval((function(){t._keypressCooldown+=t.LISTENER_INTERRUPT;var e,n,r=(e=navigator.getGamepads(),n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,n)||function(t,e){if(t){if("string"==typeof t)return gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=!1,i=null;r.buttons.forEach((function(t,e){1===t.value&&(i=e,o=!0)})),o&&xt(t,Et,At).call(t,i)}),t.LISTENER_INTERRUPT)}))}function At(t){12===t&&(this._context.moveToUp(),this._keypressCooldown=0),13===t&&(this._context.moveToDown(),this._keypressCooldown=0),14===t&&(this._context.moveToLeft(),this._keypressCooldown=0),15===t&&(this._context.moveToRight(),this._keypressCooldown=0),this._keypressCooldown>=this.KEYPRESS_INTERRUPT&&(8===t&&(this._context.isPaused?(this._context.start(),this._keypressCooldown=0):(this._context.stop(),this._keypressCooldown=0)),9===t&&(this._context.clear(),this._context.start(),this._keypressCooldown=0))}function Ct(){return"getGamepads"in window.navigator}const Lt=kt((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_t(this,Rt),_t(this,Et),_t(this,Pt),_t(this,Tt),this._context=e,xt(this,Tt,Ot).call(this)}));function Wt(t){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wt(t)}function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Wt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Wt(o)?o:String(o)),r)}var o}function Mt(){return Mt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Gt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Mt.apply(this,arguments)}function Gt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$t(t)););return t}function Dt(t,e){return Dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Dt(t,e)}function Nt(t,e){if(e&&("object"===Wt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ht(t)}function Ht(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}function Ut(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function qt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Kt=new WeakSet,zt=new WeakSet,Bt=new WeakSet,Yt=new WeakSet,Xt=new WeakSet,Jt=new WeakSet,Qt=new WeakSet,Ft=new WeakSet,Vt=new WeakSet;function Zt(){this.map=new h(this.$MAP_WRAPPER,this.MAP_WIDTH,this.MAP_HEIGHT),this.dialog=new c(this.$DIALOG_WRAPPER,this.WIN_SCORE),this.snake=new k(this.MAP_WIDTH,this.MAP_HEIGHT),this.timer=new rt,this.score=new at,this.factories=[new M,new G,new D,new N,new H,new $],this.things=[],this.borders=[];for(var t=0;t<5;t++)this.borders.push(this.factories[0].createThing());for(var e=0;e<2;e++)this.things.push(this.factories[1].createThing())}function te(){qt(this,Bt,ee).call(this),qt(this,Yt,ne).call(this),qt(this,Xt,re).call(this)}function ee(){this.snake.update(),this.things.forEach((function(t){t.update()}))}function ne(){this.map.draw(),this.snake.draw(),this.things.forEach((function(t){t.draw()})),this.borders.forEach((function(t){t.draw()})),this.$TIMER.innerText="Time: ".concat(this.timer.value),this.$SCORE.innerText="Score: ".concat(this.score.value)}function re(){var e=this;if(this.score.value>=3?this.snake.canGrow=!0:this.snake.canGrow=!1,this.things.forEach((function(t,n){t.rottingStage>t.maxRottingStage&&e.things.splice(n,1),e.snake.x===t.x&&e.snake.y===t.y&&(document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.contains("apple")&&(e.snake.canGrow&&e.snake.maxTails++,e.score.increase(1),e.map.draw(),e.snake.draw(),e.borders.forEach((function(t){t.draw()})),e.things.splice(n,1)),document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.contains("mouse")&&(e.snake.canGrow&&e.snake.maxTails++,e.score.increase(5),e.map.draw(),e.snake.draw(),e.borders.forEach((function(t){t.draw()})),e.things.splice(n,1)),document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.contains("holywater")&&(e.snake.maxTails>=5&&(e.snake.maxTails-=2,e.snake.tails.pop(),e.snake.tails.pop()),e.map.draw(),e.snake.draw(),e.borders.forEach((function(t){t.draw()})),e.things.splice(n,1)),document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.contains("crap")&&(e.snake.maxTails>=5&&(e.snake.maxTails-=2,e.snake.tails.pop(),e.snake.tails.pop()),e.score.decrease(10),e.map.draw(),e.snake.draw(),e.borders.forEach((function(t){t.draw()})),e.score.value<0&&(e.snake.isAlive=!1,e.dialog.end(e.score.value),e.setGameOver())),document.querySelector('[x = "'.concat(t.x,'"][y = "').concat(t.y,'"]')).classList.contains("bomb")&&(e.snake.isAlive=!1,e.dialog.end(e.score.value),e.setGameOver()))})),this.things.length<2){var n=t(1,100),r=0;n<=80?r=1:n>80&&n<=85?r=2:n>85&&n<=90?r=3:n>90&&n<=95?r=4:n>95&&(r=5),this.things.push(this.factories[r].createThing()),this.things.forEach((function(t){t.draw()}))}(document.querySelector(".snakeHead").classList.contains("snakeTail")||document.querySelector(".snakeHead").classList.contains("border")||this.score.value>=this.WIN_SCORE)&&(this.snake.isAlive=!1,this.dialog.end(this.score.value),this.setGameOver())}function oe(){var t=this,e=0,n=0,r=0,o=0;this.$MAP_WRAPPER.addEventListener("touchstart",(function(t){e=t.touches[0].pageX,n=t.touches[0].pageY})),this.$MAP_WRAPPER.addEventListener("touchend",(function(i){r=i.changedTouches[0].pageX,o=i.changedTouches[0].pageY;var a=r-e,c=o-n,s=Math.abs(a)>Math.abs(c),u=Math.abs(c)>Math.abs(a);!0===t.snake.canRotate&&(a>0&&s&&"Left"!==t.snake.direction?(t.snake.dx=1,t.snake.dy=0,t.snake.direction="Right",t.snake.canRotate=!1):a<0&&s&&"Right"!==t.snake.direction?(t.snake.dx=-1,t.snake.dy=0,t.snake.direction="Left",t.snake.canRotate=!1):c>0&&u&&"Up"!==t.snake.direction?(t.snake.dx=0,t.snake.dy=-1,t.snake.direction="Down",t.snake.canRotate=!1):c<0&&u&&"Down"!==t.snake.direction&&(t.snake.dx=0,t.snake.dy=1,t.snake.direction="Up",t.snake.canRotate=!1))}))}function ie(){this.MAP_WIDTH=15,this.MAP_HEIGHT=15,this.WIN_SCORE=100}function ae(){this.$MAP_WRAPPER=document.querySelector("#map"),this.$DIALOG_WRAPPER=document.querySelector("#dialog"),this.$TIMER=document.querySelector("#timer"),this.$SCORE=document.querySelector("#score")}function ce(){this._keyboard=new bt(this),this._gamepads=new Lt(this),qt(this,Jt,oe).call(this)}new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dt(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$t(r);if(o){var n=$t(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Nt(this,t)});function a(){var t,e,n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Ut(Ht(r=i.call(this)),Vt),Ut(Ht(r),Ft),Ut(Ht(r),Qt),Ut(Ht(r),Jt),Ut(Ht(r),Xt),Ut(Ht(r),Yt),Ut(Ht(r),Bt),Ut(Ht(r),zt),Ut(Ht(r),Kt),r.SPEED_RATE=null!==(t=r._params)&&void 0!==t&&t.speedRate&&"number"==typeof(null===(e=r._params)||void 0===e?void 0:e.speedRate)?null===(n=r._params)||void 0===n?void 0:n.speedRate:250,qt(Ht(r),Ft,ae).call(Ht(r)),qt(Ht(r),Qt,ie).call(Ht(r)),qt(Ht(r),Vt,ce).call(Ht(r)),qt(Ht(r),Kt,Zt).call(Ht(r)),r}return e=a,(n=[{key:"moveToLeft",value:function(){!0===this.snake.canRotate&&"Right"!==this.snake.direction&&(this.snake.dx=-1,this.snake.dy=0,this.snake.direction="Left",this.snake.canRotate=!1)}},{key:"moveToUp",value:function(){!0===this.snake.canRotate&&"Down"!==this.snake.direction&&(this.snake.dx=0,this.snake.dy=1,this.snake.direction="Up",this.snake.canRotate=!1)}},{key:"moveToRight",value:function(){!0===this.snake.canRotate&&"Left"!==this.snake.direction&&(this.snake.dx=1,this.snake.dy=0,this.snake.direction="Right",this.snake.canRotate=!1)}},{key:"moveToDown",value:function(){!0===this.snake.canRotate&&"Up"!==this.snake.direction&&(this.snake.dx=0,this.snake.dy=-1,this.snake.direction="Down",this.snake.canRotate=!1)}},{key:"start",value:function(){Mt($t(a.prototype),"start",this).call(this),this.interval=setInterval(qt(this,zt,te).bind(this),this.SPEED_RATE)}},{key:"clear",value:function(){Mt($t(a.prototype),"clear",this).call(this),qt(this,Kt,Zt).call(this)}}])&&It(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(ht))({speedRate:200}).start()})();